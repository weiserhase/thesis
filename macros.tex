% use this for typesetting a chapter without a number, e.g. intro and outro
\def\chapwithtoc#1{\chapter*{#1}\addcontentsline{toc}{chapter}{#1}}

% If there is a line/figure overflowing into page margin, this will make the
% problem evident by drawing a thick black line at the overflowing spot. You
% should not disable this.
\overfullrule=3mm

% The maximum stretching of a space. Increasing this makes the text a bit more
% sloppy, but may prevent the overflows by moving words to next line.
\emergencystretch=1em

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{definition}{Definition}
\theoremstyle{remark}
\newtheorem*{corrolary}{Corollary}

% real/natural numbers
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}

% asymptotic complexity
\newcommand{\asy}[1]{\mathcal{O}(#1)}

% listings and default lstlisting config (remove if unused)
\DeclareNewFloatType{listing}{}
\floatsetup[listing]{style=ruled}

\DeclareCaptionStyle{thesis}{style=base,font={small,sf},labelfont=bf,labelsep=quad}
\captionsetup{style=thesis}
\captionsetup[algorithm]{style=thesis,singlelinecheck=off}
\captionsetup[listing]{style=thesis,singlelinecheck=off}

% Customization of algorithmic environment (comment style)
\renewcommand{\algorithmiccomment}[1]{\textcolor{black!25}{\dotfill\sffamily\itshape#1}}

\floatname{listing}{Listing}
\lstset{ % use this to define styling for any other language
  language=C++,
  tabsize=2,
  showstringspaces=false,
  basicstyle=\footnotesize\tt\color{black!75},
  identifierstyle=\bfseries\color{black},
  commentstyle=\color{green!50!black},
  stringstyle=\color{red!50!black},
  keywordstyle=\color{blue!75!black}}

% Here's how you define a custom language, Effekt is used here as an example
\lstdefinelanguage{Effekt}{
  morekeywords={%
      let,true,false,val,var,if,else,while,type,effect,interface,%
      try,with,case,do,fun,match,def,module,import,export,extern,%
      include,record,box,unbox,return,region,resource,%
      new,and,is,namespace,pure},
  otherkeywords={=>},
  alsoletter={?,!},
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[n]{/*}{*/},
  morestring=[b]",
  morestring=[b]',
  morestring=[b]"""
}[keywords,comments,strings]

\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}

\usepackage{listings}
\lstdefinestyle{code}{
  basicstyle=\ttfamily\small,
  columns=fullflexible, keepspaces=true,
  showstringspaces=false, frame=single
}
% (Optional) light keyword coloring for readability
\lstdefinelanguage{Astra}%
{morekeywords={let,fn,return,replicate,permute,sum,max,zeros_like,axis,axes},%
  sensitive=true}

\lstdefinelanguage{ArrayDSL}%
{morekeywords={let,in,ret,sum,max,div},%
  sensitive=true}

% Make a few Unicode symbols render reliably in listings (pdflatex)
\lstset{literate=
  {×}{{$\times$}}1
{⩥}{{$\mathbin{\unicode{x2A65}}$}}1
{⟨}{{$\langle$}}1
{⟩}{{$\rangle$}}1
}
% ----- Basic symbols & helpers -----
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\Float}{\mathbb{R}}
\newcommand{\Shape}{\mathsf{Shape}}
\newcommand{\Ctx}{\mathsf{Ctx}}
\newcommand{\Permsym}{\mathsf{Perm}}
\newcommand{\Binop}{\mathsf{Binop}}
\newcommand{\append}{\mathbin{+\!\!+}}
\newcommand{\size}{\operatorname{size}}
\newcommand{\Indices}{\operatorname{Indices}}
\newcommand{\judg}[3]{#1 \vdash #2 : #3}
\newcommand{\mem}{\in}
\newcommand{\Coloneqq}{\mathrel{::=}}